/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.0 		*/
/*  Created On : 28-oct-2025 5:37:53 PM 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

SET FOREIGN_KEY_CHECKS=0
; 
/* Drop Tables */

DROP TABLE IF EXISTS `PRODUCTOS` CASCADE
;

DROP TABLE IF EXISTS `PRESUPUESTOS` CASCADE
;

DROP TABLE IF EXISTS `PEDIDOS` CASCADE
;

DROP TABLE IF EXISTS `FARMACIAS` CASCADE
;

DROP TABLE IF EXISTS `USUARIOS` CASCADE
;

/* Create Tables */

CREATE TABLE `FARMACIAS`
(
	`ID_Farmacia` INT NOT NULL AUTO_INCREMENT,
	`RazonSocial` VARCHAR(50) NOT NULL,
	`CUIT_CUIL` VARCHAR(50) NOT NULL,
	`HorarioAtencion` VARCHAR(100) NOT NULL,
	`Provincia` VARCHAR(50) NOT NULL,
	`Localidad` VARCHAR(50) NOT NULL,
	`CP` VARCHAR(10) NOT NULL,
	`Direccion` VARCHAR(50) NOT NULL,
	`Telefono` VARCHAR(15) NOT NULL,
	`Email` VARCHAR(320) NOT NULL,
	`Password` VARCHAR(255) NOT NULL,
	CONSTRAINT `PK_FARMACIAS` PRIMARY KEY (`ID_Farmacia` ASC)
)

;

CREATE TABLE `PEDIDOS`
(
	`ID_Pedido` INT NOT NULL AUTO_INCREMENT,
	`ID_Usuario` INT NOT NULL,
	`Receta` BLOB NOT NULL,
	`FechaCreacion` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	CONSTRAINT `PK_PEDIDOS` PRIMARY KEY (`ID_Pedido` ASC)
)

;

CREATE TABLE `PRESUPUESTOS`
(
	`ID_Presupuesto` INT NOT NULL AUTO_INCREMENT,
	`ID_Pedido` INT NOT NULL,
	`ID_Farmacia` INT NOT NULL,
	`FechaCreacion` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	`Aceptado` TINYINT NOT NULL DEFAULT 0,
	`FechaAceptacion` DATETIME NULL,
	`Entregado` TINYINT NOT NULL DEFAULT 0,
	`FechaEntrega` DATETIME NULL,
	`FechaEnvio` DATETIME NULL,
	`Codigo` VARCHAR(6) NULL,
	CONSTRAINT `PK_PRESUPUESTOS` PRIMARY KEY (`ID_Presupuesto` ASC)
)

;

CREATE TABLE `PRODUCTOS`
(
	`ID` INT NOT NULL AUTO_INCREMENT,
	`ID_Presupuesto` INT NOT NULL,
	`NombreComercial` VARCHAR(50) NOT NULL,
	`NombreGenerico` VARCHAR(50) NOT NULL,
	`Formato` VARCHAR(50) NULL,
	`Precio` DECIMAL(10,2) NOT NULL,
	`Cantidad` TINYINT NOT NULL,
	`BajoReceta` TINYINT NOT NULL DEFAULT 1,
	CONSTRAINT `PK_PRODUCTOS` PRIMARY KEY (`ID` ASC)
)

;

CREATE TABLE `USUARIOS`
(
	`ID_Usuario` INT NOT NULL AUTO_INCREMENT,
	`Nombre` VARCHAR(30) NOT NULL,
	`Apellido` VARCHAR(30) NOT NULL,
	`Email` VARCHAR(320) NOT NULL,
	`Telefono` VARCHAR(15) NOT NULL,
	`DNI` VARCHAR(15) NOT NULL,
	`Provincia` VARCHAR(50) NOT NULL,
	`Localidad` VARCHAR(50) NOT NULL,
	`CP` VARCHAR(10) NOT NULL,
	`Direccion` VARCHAR(40) NOT NULL,
	`TieneObraSocial` TINYINT NOT NULL,
	`ObraSocial` VARCHAR(20) NULL,
	`NroCarnet` VARCHAR(15) NULL,
	`Password` VARCHAR(255) NOT NULL,
	CONSTRAINT `PK_USUARIOS` PRIMARY KEY (`ID_Usuario` ASC)
)

;

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `PEDIDOS` 
 ADD INDEX `IXFK_PEDIDOS_USUARIOS` (`ID_Usuario` ASC)
;

ALTER TABLE `PRESUPUESTOS` 
 ADD INDEX `IXFK_PRESUPUESTOS_FARMACIAS` (`ID_Farmacia` ASC)
;

ALTER TABLE `PRESUPUESTOS` 
 ADD INDEX `IXFK_PRESUPUESTOS_PEDIDOS` (`ID_Pedido` ASC)
;

ALTER TABLE `PRODUCTOS` 
 ADD INDEX `IXFK_PRODUCTOS_PRESUPUESTOS` (`ID_Presupuesto` ASC)
;

/* Create Foreign Key Constraints */

ALTER TABLE `PEDIDOS` 
 ADD CONSTRAINT `FK_PEDIDOS_USUARIOS`
	FOREIGN KEY (`ID_Usuario`) REFERENCES `USUARIOS` (`ID_Usuario`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `PRESUPUESTOS` 
 ADD CONSTRAINT `FK_PRESUPUESTOS_FARMACIAS`
	FOREIGN KEY (`ID_Farmacia`) REFERENCES `FARMACIAS` (`ID_Farmacia`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `PRESUPUESTOS` 
 ADD CONSTRAINT `FK_PRESUPUESTOS_PEDIDOS`
	FOREIGN KEY (`ID_Pedido`) REFERENCES `PEDIDOS` (`ID_Pedido`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `PRODUCTOS` 
 ADD CONSTRAINT `FK_PRODUCTOS_PRESUPUESTOS`
	FOREIGN KEY (`ID_Presupuesto`) REFERENCES `PRESUPUESTOS` (`ID_Presupuesto`) ON DELETE Restrict ON UPDATE Restrict
;

SET FOREIGN_KEY_CHECKS=1
; 
